<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CitraScope Dashboard</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="container">
        <header>
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <h1>ðŸ”­ CitraScope</h1>
                    <p>
                        <span class="status-indicator" id="wsStatus"></span>
                        <span id="wsStatusText">Connecting...</span>
                        <span id="reconnectInfo" style="margin-left: 10px; color: #718096; font-size: 0.9em;"></span>
                        <span style="margin-left: 20px;" class="timestamp" id="lastUpdate"></span>
                    </p>
                </div>
                <div>
                    <a id="taskScopeButton" href="#" target="_blank" style="display: none; padding: 12px 24px; background-color: #4299e1; color: white; text-decoration: none; border-radius: 6px; font-weight: bold; font-size: 1.1em;">Task My Scope</a>
                </div>
            </div>
        </header>

        <div class="grid">
            <div class="card">
                <h2>System Status</h2>
                <div class="info-row">
                    <span class="info-label">Hardware Adapter</span>
                    <span class="info-value" id="hardwareAdapter">-</span>
                </div>
                <div class="info-row">
                    <span class="info-label">Telescope Connected</span>
                    <span class="info-value" id="telescopeConnected">-</span>
                </div>
                <div class="info-row">
                    <span class="info-label">Camera Connected</span>
                    <span class="info-value" id="cameraConnected">-</span>
                </div>
                <div class="info-row">
                    <span class="info-label">Current Task</span>
                    <span class="info-value task-id" id="currentTask">None</span>
                </div>
                <div class="info-row">
                    <span class="info-label">Tasks Pending</span>
                    <span class="info-value" id="tasksPending">0</span>
                </div>
            </div>

            <div class="card">
                <h2>Telescope</h2>
                <div class="info-row">
                    <span class="info-label">Right Ascension</span>
                    <span class="info-value" id="telescopeRA">-</span>
                </div>
                <div class="info-row">
                    <span class="info-label">Declination</span>
                    <span class="info-value" id="telescopeDEC">-</span>
                </div>
                <div class="info-row">
                    <span class="info-label">Ground Station</span>
                    <span class="info-value" id="groundStationName">-</span>
                </div>
            </div>

            <div class="card">
                <h2>Task Queue</h2>
                <div class="task-list" id="taskList">
                    <p style="color: #a0aec0;">Loading tasks...</p>
                </div>
            </div>
        </div>

        <div class="config-section">
            <h2>Configuration</h2>
            <div class="grid">
                <div class="form-group">
                    <label for="hardwareAdapterSelect">Hardware Adapter</label>
                    <select id="hardwareAdapterSelect">
                        <option value="indi">INDI</option>
                        <option value="nina">NINA</option>
                        <option value="kstars">KStars</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="telescopeId">Telescope ID</label>
                    <input type="text" id="telescopeId" placeholder="Enter telescope ID">
                </div>
                <div class="form-group">
                    <label for="logLevel">Log Level</label>
                    <select id="logLevel">
                        <option value="DEBUG">DEBUG</option>
                        <option value="INFO">INFO</option>
                        <option value="WARNING">WARNING</option>
                        <option value="ERROR">ERROR</option>
                    </select>
                </div>
            </div>
            <button onclick="saveConfig()">Save Configuration (Requires Restart)</button>
        </div>

        <!-- Roll-up Terminal Overlay -->
        <div id="rollupTerminal" class="rollup-terminal-collapsed">
            <div class="log-terminal-header">
                <button id="toggleLogTerminal" title="Expand/collapse logs">
                    <span id="logToggleIcon">&#9650;</span>
                </button>
                <div class="log-collapsed-bar" id="logCollapsedBar">
                    <span id="latestLogLine" style="font-family: monospace; color: #e2e8f0;"></span>
                </div>
            </div>
            <div class="log-container" id="logContainer">
                <p style="color: #a0aec0;">Loading logs...</p>
            </div>
        </div>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>
